---

title: API


keywords: fastai
sidebar: home_sidebar

summary: "This module is as close as possible to the barebone <a href='https://github.com/Medium/medium-api-docs#33-posts'>Medium API</a> but written in python instead of GET/POST commands. Not all the kinds requests are implemented, only the ones that are useful to post an article or an image"
description: "This module is as close as possible to the barebone <a href='https://github.com/Medium/medium-api-docs#33-posts'>Medium API</a> but written in python instead of GET/POST commands. Not all the kinds requests are implemented, only the ones that are useful to post an article or an image"
nb_path: "nbs/00_API.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/00_API.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="base_request" class="doc_header"><code>base_request</code><a href="https://github.com/lc5415/nb2medium/tree/master/nb2medium/API.py#L11" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>base_request</code>()</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Fetch-User-Data">Fetch User Data<a class="anchor-link" href="#Fetch-User-Data"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The basic user data can be requested by passing the Medium Integration token via a GET request. The Medium Integration Token needs to be requested from the writer's Medium profile page. For now, this token should be stored as an environment variable under the user's <code>$HOME/.profile</code> file:</p>
<div class="highlight"><pre><span></span>export MEDIUM_TOKEN=&lt;the-token&gt;
</pre></div>
<p>I may consider using keyring to store the token locally as that may more user friendly.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="auth_header" class="doc_header"><code>auth_header</code><a href="https://github.com/lc5415/nb2medium/tree/master/nb2medium/API.py#L24" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>auth_header</code>(<strong><code>token</code></strong>=<em><code>None</code></em>, <strong><code>test</code></strong>=<em><code>False</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="fetch_user_data" class="doc_header"><code>fetch_user_data</code><a href="https://github.com/lc5415/nb2medium/tree/master/nb2medium/API.py#L30" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>fetch_user_data</code>(<strong><code>test</code></strong>=<em><code>False</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">fetch_user_data</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">a</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;data&#39;: {&#39;id&#39;: &#39;1e344db7dfd2a8efa9698a758030e05e28ff4c396f1f87f003704e0a8a80b9656&#39;,
  &#39;username&#39;: &#39;lucha6&#39;,
  &#39;name&#39;: &#39;Luis Chaves&#39;,
  &#39;url&#39;: &#39;https://medium.com/@lucha6&#39;,
  &#39;imageUrl&#39;: &#39;https://cdn-images-1.medium.com/fit/c/400/400/0*rM2cEh8f6ZQMOAZK.jpg&#39;}}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Which is equivalent to the <code>curl</code> alternative:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>curl -s -H <span class="s2">&quot;Authorization: Bearer </span><span class="nv">$MEDIUM_TOKEN</span><span class="s2">&quot;</span> https://api.medium.com/v1/me <span class="p">|</span> jq
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre><span class="ansi-bold">{
  </span><span class="ansi-blue-intense-fg ansi-bold">&#34;data&#34;</span><span class="ansi-bold">: </span><span class="ansi-bold">{
    </span><span class="ansi-blue-intense-fg ansi-bold">&#34;id&#34;</span><span class="ansi-bold">: </span><span class="ansi-green-fg">&#34;1e344db7dfd2a8efa9698a758030e05e28ff4c396f1f87f003704e0a8a80b9656&#34;</span><span class="ansi-bold">,
    </span><span class="ansi-blue-intense-fg ansi-bold">&#34;username&#34;</span><span class="ansi-bold">: </span><span class="ansi-green-fg">&#34;lucha6&#34;</span><span class="ansi-bold">,
    </span><span class="ansi-blue-intense-fg ansi-bold">&#34;name&#34;</span><span class="ansi-bold">: </span><span class="ansi-green-fg">&#34;Luis Chaves&#34;</span><span class="ansi-bold">,
    </span><span class="ansi-blue-intense-fg ansi-bold">&#34;url&#34;</span><span class="ansi-bold">: </span><span class="ansi-green-fg">&#34;https://medium.com/@lucha6&#34;</span><span class="ansi-bold">,
    </span><span class="ansi-blue-intense-fg ansi-bold">&#34;imageUrl&#34;</span><span class="ansi-bold">: </span><span class="ansi-green-fg">&#34;https://cdn-images-1.medium.com/fit/c/400/400/0*rM2cEh8f6ZQMOAZK.jpg&#34;</span><span class="ansi-bold">
  </span><span class="ansi-bold">}</span><span class="ansi-bold">
</span><span class="ansi-bold">}</span>
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="s1">&#39;data&#39;</span> <span class="ow">in</span> <span class="n">fetch_user_data</span><span class="p">()</span><span class="o">.</span><span class="n">json</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Get-User-ID">Get User ID<a class="anchor-link" href="#Get-User-ID"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="get_user_id" class="doc_header"><code>get_user_id</code><a href="https://github.com/lc5415/nb2medium/tree/master/nb2medium/API.py#L34" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>get_user_id</code>(<strong><code>test</code></strong>=<em><code>False</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">get_user_id</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&#39;1e344db7dfd2a8efa9698a758030e05e28ff4c396f1f87f003704e0a8a80b9656&#39;</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">get_user_id</span><span class="p">(</span><span class="n">test</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&#39;16eaaf7a06cf688353bd560c48dd5ef7fa1f0350adc3d0d211f596e698115e308&#39;</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Fetch-User-Publications">Fetch User Publications<a class="anchor-link" href="#Fetch-User-Publications"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can also request the user's publications. In Medium's definition a publication is not an article but rather an editorial-like group under which articles are written (e.g. Towards Data Science, Elemental AI...)</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="fetch_publications" class="doc_header"><code>fetch_publications</code><a href="https://github.com/lc5415/nb2medium/tree/master/nb2medium/API.py#L38" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>fetch_publications</code>()</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fetch_publications</span><span class="p">()</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;data&#39;: [{&#39;id&#39;: &#39;7f60cf5620c9&#39;,
   &#39;name&#39;: &#39;Towards Data Science&#39;,
   &#39;description&#39;: &#39;Your home for data science. A Medium publication sharing concepts, ideas and codes.&#39;,
   &#39;url&#39;: &#39;https://medium.com/towards-data-science&#39;,
   &#39;imageUrl&#39;: &#39;https://cdn-images-1.medium.com/fit/c/400/400/1*hVxgUA6kP-PgL5TJjuyePg.png&#39;},
  {&#39;id&#39;: &#39;4b3a1ed4f11c&#39;,
   &#39;name&#39;: &#39;JavaScript in Plain English&#39;,
   &#39;description&#39;: &#39;New JavaScript and Web Development articles every day.&#39;,
   &#39;url&#39;: &#39;https://medium.com/javascript-in-plain-english&#39;,
   &#39;imageUrl&#39;: &#39;https://cdn-images-1.medium.com/fit/c/400/400/1*4F1ZAI1i-eruO4PnbNvTZg@2x.png&#39;},
  {&#39;id&#39;: &#39;261e46dce6ca&#39;,
   &#39;name&#39;: &#39;&lt;pretty/code&gt;&#39;,
   &#39;description&#39;: &#39;Topics centered around Ruby, Rails, Coffeescript, Vim, Tmux and Productivity.&#39;,
   &#39;url&#39;: &#39;https://medium.com/raise-coffee&#39;,
   &#39;imageUrl&#39;: &#39;https://cdn-images-1.medium.com/fit/c/400/400/1*pLo2lxSseBKg09Nc_1EOlw.png&#39;},
  {&#39;id&#39;: &#39;3a8144eabfe3&#39;,
   &#39;name&#39;: &#39;HackerNoon.com&#39;,
   &#39;description&#39;: &#39;Elijah McClain, George Floyd, Eric Garner, Breonna Taylor, Ahmaud Arbery, Michael Brown, Oscar Grant, Atatiana Jefferson, Tamir Rice, Bettie Jones, Botham Jean&#39;,
   &#39;url&#39;: &#39;https://medium.com/hackernoon&#39;,
   &#39;imageUrl&#39;: &#39;https://cdn-images-1.medium.com/fit/c/400/400/1*76XiKOa05Yya6_CdYX8pVg.jpeg&#39;},
  {&#39;id&#39;: &#39;5517fd7b58a6&#39;,
   &#39;name&#39;: &#39;Level Up Coding&#39;,
   &#39;description&#39;: &#39;Coding tutorials and news. The developer homepage gitconnected.com&#39;,
   &#39;url&#39;: &#39;https://medium.com/gitconnected&#39;,
   &#39;imageUrl&#39;: &#39;https://cdn-images-1.medium.com/fit/c/400/400/1*5D9oYBd58pyjMkV_5-zXXQ.jpeg&#39;},
  {&#39;id&#39;: &#39;8d6b8a439e32&#39;,
   &#39;name&#39;: &#39;Elemental&#39;,
   &#39;description&#39;: &#39;Your life, sourced by science. A publication from Medium about health and wellness.&#39;,
   &#39;url&#39;: &#39;https://medium.com/elemental-by-medium&#39;,
   &#39;imageUrl&#39;: &#39;https://cdn-images-1.medium.com/fit/c/400/400/1*GhG8ZeoE0TGfCHwL9SCrfw.png&#39;},
  {&#39;id&#39;: &#39;98111c9905da&#39;,
   &#39;name&#39;: &#39;Towards AI&#39;,
   &#39;description&#39;: &#39;Towards AI is the world’s leading multidisciplinary science publication. Towards AI publishes the best of tech, science, and engineering. Read by thought-leaders and decision-makers around the world.&#39;,
   &#39;url&#39;: &#39;https://medium.com/towards-artificial-intelligence&#39;,
   &#39;imageUrl&#39;: &#39;https://cdn-images-1.medium.com/fit/c/400/400/1*JyIThO-cLjlChQLb6kSlVQ.png&#39;},
  {&#39;id&#39;: &#39;b7e45b22fec3&#39;,
   &#39;name&#39;: &#39;Creators Hub&#39;,
   &#39;description&#39;: &#39;The Creators Hub is your source of ongoing education and inspiration to help your presence on Medium grow and support your creative practice. You’ll find tips on the craft of writing, spotlights on thinkers across the platform, and advice from Medium editors and fellow writers.&#39;,
   &#39;url&#39;: &#39;https://medium.com/creators-hub&#39;,
   &#39;imageUrl&#39;: &#39;https://cdn-images-1.medium.com/fit/c/400/400/1*8Zti0Ox8AfGECDO_O1Ifug.png&#39;},
  {&#39;id&#39;: &#39;d0b105d10f0a&#39;,
   &#39;name&#39;: &#39;Better Programming&#39;,
   &#39;description&#39;: &#39;Advice for programmers.&#39;,
   &#39;url&#39;: &#39;https://medium.com/better-programming&#39;,
   &#39;imageUrl&#39;: &#39;https://cdn-images-1.medium.com/fit/c/400/400/1*TyRLQdZO7NdPATwSeut8gg.png&#39;},
  {&#39;id&#39;: &#39;f5105b08f43a&#39;,
   &#39;name&#39;: &#39;DailyJS&#39;,
   &#39;description&#39;: &#39;JavaScript news and opinion.&#39;,
   &#39;url&#39;: &#39;https://medium.com/dailyjs&#39;,
   &#39;imageUrl&#39;: &#39;https://cdn-images-1.medium.com/fit/c/400/400/1*3RTyL2e-UvYez9Qo4YuFiA.png&#39;},
  {&#39;id&#39;: &#39;f5af2b715248&#39;,
   &#39;name&#39;: &#39;The Startup&#39;,
   &#39;description&#39;: &#34;Medium&#39;s largest active publication, followed by +768K people. Follow to join our community.&#34;,
   &#39;url&#39;: &#39;https://medium.com/swlh&#39;,
   &#39;imageUrl&#39;: &#39;https://cdn-images-1.medium.com/fit/c/400/400/1*Xd2uZaVHfrGOP14W_3UQRg.jpeg&#39;}]}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="s1">&#39;data&#39;</span> <span class="ow">in</span> <span class="n">fetch_publications</span><span class="p">()</span><span class="o">.</span><span class="n">json</span><span class="p">()</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Post-an-Article">Post an Article<a class="anchor-link" href="#Post-an-Article"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As easily an article can be submitted. Many options are available which can be explored in the <a href="https://github.com/Medium/medium-api-docs#33-posts">Medium API official docs</a>. The possible parameters and parameter values are as follow:</p>
<table>
<thead><tr>
<th>Parameter</th>
<th>Type</th>
<th>Required?</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>title</td>
<td>string</td>
<td>required</td>
<td>The title of the post. Note that this title is used for SEO and when rendering the post as a listing, but will not appear in the actual post—for that, the title must be specified in the <code>content</code> field as well. Titles longer than 100 characters will be ignored. In that case, a title will be synthesized from the first content in the post when it is published.</td>
</tr>
<tr>
<td>contentFormat</td>
<td>string</td>
<td>required</td>
<td>The format of the "content" field. There are two valid values, "html", and "markdown"</td>
</tr>
<tr>
<td>content</td>
<td>string</td>
<td>required</td>
<td>The body of the post, in a valid, semantic, HTML fragment, or Markdown. Further markups may be supported in the future. For a full list of accepted HTML tags, see <a href="https://medium.com/@katie/a4367010924e">here</a>. If you want your title to appear on the post page, you must also include it as part of the post content.</td>
</tr>
<tr>
<td>tags</td>
<td>string array</td>
<td>optional</td>
<td>Tags to classify the post. Only the first three will be used. Tags longer than 25 characters will be ignored.</td>
</tr>
<tr>
<td>canonicalUrl</td>
<td>string</td>
<td>optional</td>
<td>The original home of this content, if it was originally published elsewhere.</td>
</tr>
<tr>
<td>publishStatus</td>
<td>enum</td>
<td>optional</td>
<td>The status of the post. Valid values are “public”, “draft”, or “unlisted”. The default is “public”.</td>
</tr>
<tr>
<td>license</td>
<td>enum</td>
<td>optional</td>
<td>The license of the post. Valid values are “all-rights-reserved”, “cc-40-by”, “cc-40-by-sa”, “cc-40-by-nd”, “cc-40-by-nc”, “cc-40-by-nc-nd”, “cc-40-by-nc-sa”, “cc-40-zero”, “public-domain”. The default is “all-rights-reserved”.</td>
</tr>
<tr>
<td>notifyFollowers</td>
<td>bool</td>
<td>optional</td>
<td>Whether to notifyFollowers that the user has published.</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The default <code>publishStatus</code> for posting articles will <strong>always</strong> be set to 'draft' because that is how I would always like to use this API.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="post_article" class="doc_header"><code>post_article</code><a href="https://github.com/lc5415/nb2medium/tree/master/nb2medium/API.py#L42" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>post_article</code>(<strong><code>title</code></strong>, <strong><code>content</code></strong>, <strong><code>contentFormat</code></strong>=<em><code>'markdown'</code></em>, <strong><code>tags</code></strong>=<em><code>None</code></em>, <strong><code>canonicalUrl</code></strong>=<em><code>None</code></em>, <strong><code>publishStatus</code></strong>=<em><code>'draft'</code></em>, <strong><code>license</code></strong>=<em><code>None</code></em>, <strong><code>notifyFollowers</code></strong>=<em><code>False</code></em>, <strong><code>test</code></strong>=<em><code>False</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Which is equivalent to:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>curl <span class="err">\</span>
  <span class="o">-</span><span class="n">X</span> <span class="n">POST</span> \
  <span class="o">-</span><span class="n">H</span> <span class="s2">&quot;Accept: application/vnd.github.v3+json&quot;</span> \
  <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">api</span><span class="o">.</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">gists</span> \
  <span class="o">-</span><span class="n">d</span> <span class="s1">&#39;{&quot;files&quot;:{&quot;CONTRIBUTING.md&quot;}}&#39;</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>{
  &#34;message&#34;: &#34;Requires authentication&#34;,
  &#34;documentation_url&#34;: &#34;https://docs.github.com/rest/reference/gists#create-a-gist&#34;
}
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This command posts an article via a simple POST request. If the article is correctly submitted a JSON response like the below will be returned</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Posting-a-string-of-text">Posting a string of text<a class="anchor-link" href="#Posting-a-string-of-text"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">my_post</span> <span class="o">=</span> <span class="n">post_article</span><span class="p">(</span><span class="s1">&#39;Test from nb&#39;</span><span class="p">,</span>
             <span class="s1">&#39;# Markdown title </span><span class="se">\n\n</span><span class="s1"> markdown text&#39;</span><span class="p">,</span>
             <span class="n">test</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">my_post</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;data&#39;: {&#39;id&#39;: &#39;f0d5723f4bd4&#39;,
  &#39;title&#39;: &#39;Test from nb&#39;,
  &#39;authorId&#39;: &#39;16eaaf7a06cf688353bd560c48dd5ef7fa1f0350adc3d0d211f596e698115e308&#39;,
  &#39;url&#39;: &#39;https://medium.com/@luischaveshuntington/f0d5723f4bd4&#39;,
  &#39;canonicalUrl&#39;: &#39;&#39;,
  &#39;publishStatus&#39;: &#39;draft&#39;,
  &#39;license&#39;: &#39;&#39;,
  &#39;licenseUrl&#39;: &#39;https://policy.medium.com/medium-terms-of-service-9db0094a1e0f&#39;,
  &#39;tags&#39;: []}}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The request should return the <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/201">HTTP 201 code</a></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Posting-a-text-document">Posting a text document<a class="anchor-link" href="#Posting-a-text-document"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">my_post_from_file</span> <span class="o">=</span> <span class="n">post_article</span><span class="p">(</span><span class="s1">&#39;Test from file&#39;</span><span class="p">,</span><span class="nb">open</span><span class="p">(</span><span class="s1">&#39;../tests/LEARNING.md&#39;</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span><span class="n">test</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">my_post_from_file</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;data&#39;: {&#39;id&#39;: &#39;d0daa0d04215&#39;,
  &#39;title&#39;: &#39;Test from file&#39;,
  &#39;authorId&#39;: &#39;16eaaf7a06cf688353bd560c48dd5ef7fa1f0350adc3d0d211f596e698115e308&#39;,
  &#39;url&#39;: &#39;https://medium.com/@luischaveshuntington/d0daa0d04215&#39;,
  &#39;canonicalUrl&#39;: &#39;&#39;,
  &#39;publishStatus&#39;: &#39;draft&#39;,
  &#39;license&#39;: &#39;&#39;,
  &#39;licenseUrl&#39;: &#39;https://policy.medium.com/medium-terms-of-service-9db0094a1e0f&#39;,
  &#39;tags&#39;: []}}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="n">my_post_from_file</span><span class="o">.</span><span class="n">ok</span>
<span class="k">assert</span> <span class="n">my_post_from_file</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">201</span> 
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Post/Upload-an-image">Post/Upload an image<a class="anchor-link" href="#Post/Upload-an-image"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="post_image" class="doc_header"><code>post_image</code><a href="https://github.com/lc5415/nb2medium/tree/master/nb2medium/API.py#L72" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>post_image</code>(<strong><code>filename</code></strong>=<em><code>None</code></em>, <strong><code>img</code></strong>=<em><code>None</code></em>, <strong><code>test</code></strong>=<em><code>False</code></em>)</p>
</blockquote>
<p>filename: needs to be a valid image file path supported my Medium
img: can be a binary image representation</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Upload-image-from-file">Upload image from file<a class="anchor-link" href="#Upload-image-from-file"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">my_img</span> <span class="o">=</span> <span class="n">post_image</span><span class="p">(</span><span class="s1">&#39;../tests/github-logo.png&#39;</span><span class="p">,</span> <span class="n">test</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">my_img</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;data&#39;: {&#39;url&#39;: &#39;https://cdn-images-1.medium.com/proxy/1*sV7tva-728oySeOUL0-vOw.png&#39;,
  &#39;md5&#39;: &#39;sV7tva-728oySeOUL0-vOw&#39;}}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="n">my_img</span><span class="o">.</span><span class="n">ok</span>
<span class="k">assert</span> <span class="n">my_img</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">201</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Upload-image-as-byte-stream">Upload image as byte stream<a class="anchor-link" href="#Upload-image-as-byte-stream"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">io</span> <span class="kn">import</span> <span class="n">BytesIO</span>
<span class="n">img</span> <span class="o">=</span> <span class="n">BytesIO</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="s1">&#39;../tests/github-logo.png&#39;</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">())</span><span class="o">.</span><span class="n">getvalue</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Which is some sort of byte stream: like </span><span class="si">{</span><span class="n">img</span><span class="p">[:</span><span class="mi">10</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Which is some sort of byte stream: like b&#39;\x89PNG\r\n\x1a\n\x00\x00&#39;
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">image_from_bytes</span> <span class="o">=</span> <span class="n">post_image</span><span class="p">(</span><span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;github-logo.png&#39;</span><span class="p">,</span> <span class="n">img</span> <span class="o">=</span> <span class="n">img</span><span class="p">,</span> <span class="n">test</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
<span class="n">image_from_bytes</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;data&#39;: {&#39;url&#39;: &#39;https://cdn-images-1.medium.com/proxy/1*sV7tva-728oySeOUL0-vOw.png&#39;,
  &#39;md5&#39;: &#39;sV7tva-728oySeOUL0-vOw&#39;}}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>It may not become apparent why this functionality is useful right now. Being able to upload a file as a binary stream is actually really useful because we can avoid saving the images to memory and upload them directly to Medium, the <code>nbconvert</code> modules that we will be using later represent images in such intermediate states</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Which as a <code>curl</code> call would be:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span>curl -X POST https://api.medium.com/v1/images <span class="err">\</span>
	<span class="o">-</span><span class="n">H</span> <span class="s2">&quot;Authorization: Bearer $MEDIUM_TOKEN_TEST&quot;</span> \
	<span class="o">-</span><span class="n">F</span> <span class="s1">&#39;name=&quot;image&quot;; filename=&quot;github-logo.png&quot; ; type=&quot;image/png&quot;;&#39;</span> \
	<span class="o">-</span><span class="n">F</span> <span class="s1">&#39;image=@LEARNING/github-logo.png&#39;</span> <span class="o">|</span> <span class="n">jq</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>curl: (26) Failed to open/read local data from file/application
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Posting-an-article-with-an-image">Posting an article with an image<a class="anchor-link" href="#Posting-an-article-with-an-image"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Post-with-online-image-links">Post with online image links<a class="anchor-link" href="#Post-with-online-image-links"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>It turns out that uploading a file with an online image may be easier</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;../tests/test-with-online-image.md&#39;</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">article</span><span class="p">:</span>
    <span class="n">my_post_from_file_with_online_image</span> <span class="o">=</span> <span class="n">post_article</span><span class="p">(</span>
        <span class="s1">&#39;Test from file with online image&#39;</span><span class="p">,</span>
        <span class="n">article</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span>
        <span class="n">test</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">my_post_from_file_with_online_image</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;data&#39;: {&#39;id&#39;: &#39;2c7dafd0689b&#39;,
  &#39;title&#39;: &#39;Test from file with online image&#39;,
  &#39;authorId&#39;: &#39;16eaaf7a06cf688353bd560c48dd5ef7fa1f0350adc3d0d211f596e698115e308&#39;,
  &#39;url&#39;: &#39;https://medium.com/@luischaveshuntington/2c7dafd0689b&#39;,
  &#39;canonicalUrl&#39;: &#39;&#39;,
  &#39;publishStatus&#39;: &#39;draft&#39;,
  &#39;license&#39;: &#39;&#39;,
  &#39;licenseUrl&#39;: &#39;https://policy.medium.com/medium-terms-of-service-9db0094a1e0f&#39;,
  &#39;tags&#39;: []}}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For those reading this code above, there is no way for me to show that the draft was posted succesfully and that the image is displayed correctly as the draft is posted to my account, but trust me it is posted correctly. Where as obtaining a correct JSON back is a good sign that the article was posted succesfully, the posted draft still needs to be verified and potentially modified.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;../tests/test-with-offline-image.md&#39;</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">article</span><span class="p">:</span>
    <span class="n">my_post_from_file_with_offline_image</span> <span class="o">=</span> <span class="n">post_article</span><span class="p">(</span>
        <span class="s1">&#39;Test from file with offline image&#39;</span><span class="p">,</span>
        <span class="n">article</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span>
        <span class="n">test</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">my_post_from_file_with_offline_image</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>{&#39;data&#39;: {&#39;id&#39;: &#39;47547e87d4f2&#39;,
  &#39;title&#39;: &#39;Test from file with offline image&#39;,
  &#39;authorId&#39;: &#39;16eaaf7a06cf688353bd560c48dd5ef7fa1f0350adc3d0d211f596e698115e308&#39;,
  &#39;url&#39;: &#39;https://medium.com/@luischaveshuntington/47547e87d4f2&#39;,
  &#39;canonicalUrl&#39;: &#39;&#39;,
  &#39;publishStatus&#39;: &#39;draft&#39;,
  &#39;license&#39;: &#39;&#39;,
  &#39;licenseUrl&#39;: &#39;https://policy.medium.com/medium-terms-of-service-9db0094a1e0f&#39;,
  &#39;tags&#39;: []}}</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In this case, we referred to a local image in our markdown document as opposed to one found oneline. When we post an article with references to offline/local images, the medium Markdown renderer won't recognise the path to those images and will faily to display the image. <strong>What would need to be done</strong> in this case is to get the local image paths, upload them with the <code>post_image()</code> function and then replace the local path reference by the one in the Medium DB.</p>

</div>
</div>
</div>
</div>
 

